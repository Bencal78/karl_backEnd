import numpy as np
import pandas as pd
import json
import variables as var
import sys


def return_outfit():
    """
    Retrieve the arguments send by the node server
    Create a RL object
    Update the score of the RL object
    Create a new outfit deending on the new update
    :return: a dct with keys: clothes (with the new score), cat_score (the new clothes' category scores),
            outfit (the outfit generated by the RL model)
    """
    args = sys.argv[2]
    args_json = json.loads(args)
    clothes = args_json["clothes"]
    rl_cat_score = args_json["rl_cat_score"]
    tastes = args_json["tastes"]
    rl = RL(clothes, rl_cat_score)
    clothes_cat_score = {}
    if tastes:
        for taste in tastes:
            if taste["rl_used"]:
                continue
            rl.update_value_naive(taste)
            taste["rl_used"] = True
        clothes_cat_score = rl.prepare_update_value_2()
        clothes_cat_score.update({"tastes": tastes})

    outfit = rl.create_outfit()
    clothes_cat_score.update(outfit)
    return json.dumps(clothes_cat_score, ensure_ascii=False)


class RL:
    def __init__(self, clothes, cat_score):
        self.clothes = clothes
        self.cat_score = {int(key): value for key, value in cat_score.items()}
        self.clothes_df = self.create_df_clothes(clothes)
        self.space = self.create_space()
        self.cat_score_s = self.create_cat_score_s_key_to_int()

    def create_cat_score_s_key_to_int(self):
        """
        Create a dict of Series based on cat_score and convert key from str to int
        :return:
        """
        return {int(step): pd.Series(score_dict) for step, score_dict in self.cat_score.items()}

    def cat_score_key_to_str(self):
        """
        prepare cat_score for the json node.js conversion (js function JSON.Parse cant convert int's key)
        :return:
        """
        self.cat_score = {str(step): score_dict for step, score_dict in self.cat_score.items()}

    def create_space(self):
        """
        Create a space based on the user's clothes.
        The space is a tree where node can be clothe category, or a clothe
        :return:
        """
        space = dict()
        for step, param in enumerate(var.params):
            bp, layer = param
            space[step] = {cat: self.clothes_df.loc[self.clothes_df.category == cat, ["_id", "rl_score"]].set_index("_id").rl_score
                           for cat in
                           list(self.clothes_df.loc[(self.clothes_df[bp] == 1) & (self.clothes_df.layer == layer), "category"].unique())}

            new_cats = set(space[step].keys()) - set(self.cat_score[step].keys())
            self.cat_score[step].update({cat: 0.0 for cat in new_cats})

        return space

    @staticmethod
    def create_df_clothes(clothes):
        """
        Convert a dict of clothes to a dataframe, also dummify bodypart's features
        :param clothes: a dictionnary of clothes
        :return:
        """
        clothes_df = pd.DataFrame(clothes)
        bodypart_df = pd.get_dummies(clothes_df.bodyparts.apply(pd.Series).stack()).sum(level=0).rename(
            columns=lambda x: "bp_{}".format(int(x)))
        clothes_df = pd.concat([clothes_df, bodypart_df], axis=1)
        return clothes_df

    def create_outfit(self):
        """
        Create a outfit, taking the best path depending on a rl score
        :return:
        """
        outfit_ids = list()
        for step in range(np.random.randint(1, var.n_step)+1):
            cat = self.cat_score_s[step].idxmax()
            outfit_ids.append(self.space[step][cat].idxmax())
        outfit = self.prepare_outfit(outfit_ids)
        return outfit

    def update_value_naive(self, taste):
        """
        update the rl score with a user taste
        :param taste: dict containing 2 keys: outfit (dict of clothes) and decision (bool)
        :return:
        """
        outfit, l3_not_l2 = self.reorganize_outfit(taste["clothes"])
        reward = 1 if taste["decision"] else -1

        for step, clothe in enumerate(outfit):
            if (step == 2) & l3_not_l2: step += 1
            self.space[step][clothe["category"]].loc[clothe["_id"]] += reward/(2*len(outfit))
            self.clothes_df.loc[self.clothes_df._id == clothe["_id"], "rl_score"] = self.space[step][clothe["category"]].loc[clothe["_id"]]
            self.cat_score_s[step].loc[clothe["category"]] += reward/(2*len(outfit))
        """
        self.prepare_update_value(taste)
        self.cat_score_key_to_str()
        return {"clothes": self.clothes, "rl_cat_score": self.cat_score}
        """


    @staticmethod
    def reorganize_outfit(outfit):
        """
        reorganize an outfit in this specific order:
        1. top & layer 1,
        2. bottom & layer 1
        3. top & layer 2
        4. top & layer 3
        :param outfit: a dict of clothes
        :return:
        """
        outfit_df = RL.create_df_clothes(outfit)
        sorted_ids = list()
        l3_not_l2 = False
        for step in range(outfit_df.shape[0]):
            bp, layer = var.params[step]
            try:
                sorted_ids.append(outfit_df.loc[(outfit_df[bp] == 1) & (outfit_df.layer == layer)].index.values[0])
            except IndexError:
                sorted_ids.append(outfit_df.loc[(outfit_df[bp] == 1) & (outfit_df.layer == layer+1)].index.values[0])
                l3_not_l2 = True
        outfit_sorted = [outfit[cid] for cid in sorted_ids]
        return outfit_sorted, l3_not_l2

    def prepare_outfit(self, outfit_ids):
        """
        prepapre the outfit to be send to the node server
        :param outfit_ids: a list of clothes' id
        :return:
        """
        df_ids = list(self.clothes_df.loc[self.clothes_df._id.isin(outfit_ids)].index.values)
        outfit = {'outfit': [self.clothes[cid] for cid in df_ids]}
        return outfit

    def prepare_update_value(self, taste):
        """
        prepare the update of cat_score and rl_score to be send to the node js server
        :param taste:
        :return:
        """
        outfit, l3_not_l2 = self.reorganize_outfit(taste["clothes"])
        for clothe in outfit:
            s = self.clothes_df.loc[self.clothes_df._id == clothe["_id"], "rl_score"]
            self.clothes[s.index.values[0]]["rl_score"] = s.iloc[0]
        self.cat_score = {step: serie.to_dict() for step, serie in self.cat_score_s.items()}

    def prepare_update_value_2(self):
        clothes = list(self.clothes_df.loc[:, ~self.clothes_df.columns.str.startswith('bp_')].T.to_dict().values())
        self.cat_score = {str(step): serie.to_dict() for step, serie in self.cat_score_s.items()}
        return {"clothes": clothes, "rl_cat_score": self.cat_score}

if __name__ == "__main__":

    args_json = json.loads('{"clothes":[{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c33759bf946f80646b32d08","fabrics":"jean","name":"black jean","category":"jean","pattern":"uni","temperature":5,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c3376c3f946f80646b32d0a","fabrics":"cotton","name":"bleu shirt","category":"shirt","temperature":3,"pattern":"printed","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black"],"_id":"5c33788ff946f80646b32d0b","fabrics":"wool","name":"black sweater","category":"sweater","pattern":"uni","temperature":5,"layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["purple"],"_id":"5c337903f946f80646b32d0c","fabrics":"unknown","name":"purple jogging","category":"jogging","pattern":"uni","temperature":5,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4,5],"colors":["black"],"_id":"5c337953f946f80646b32d0d","fabrics":"wool","name":"black trench","category":"trench","pattern":"uni","temperature":8,"layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["red"],"_id":"5c337ab0f946f80646b32d0e","fabrics":"cotton","name":"red tank top","category":"tanktop","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4,5],"colors":["yellow"],"_id":"5c337b4af946f80646b32d0f","fabrics":"unknown","name":"yellow coat","category":"coat","temperature":9,"layer":3,"pattern":"uni","version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c337b53f946f80646b32d10","fabrics":"cloth","name":"black work pants","category":"pants","temperature":4,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c337c2bf946f80646b32d11","fabrics":"canvas","name":"blue coat","category":"coat","temperature":9,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["blue"],"_id":"5c337d97f946f80646b32d13","fabrics":"cloth","name":"blue work pants","category":"pants","temperature":4,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black"],"_id":"5c337d9cf946f80646b32d14","fabrics":"leather","name":"black vest","category":"vest","temperature":6,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c337dfff946f80646b32d15","fabrics":"cotton","name":"blue sweater","category":"sweater","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["brown"],"_id":"5c337e66f946f80646b32d16","fabrics":"cotton","name":"brown turtle neck","category":"turtleneck","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["grey"],"_id":"5c337f96f946f80646b32d19","fabrics":"jean","name":"grey shorts","category":"shorts","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["brown"],"_id":"5c337fe1f946f80646b32d1a","fabrics":"leather","name":"brown skirt","category":"skirt","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c33815cf946f80646b32d1c","fabrics":"jean","name":"jean vest","category":"vest","pattern":"uni","temperature":4,"layer":3,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["red"],"_id":"5c3394b48234561ce924f6fe","name":"long red skirt","category":"skirt","fabrics":"suede","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["brown"],"_id":"5c33956d8234561ce924f700","name":"velor brown pants","category":"pants","fabrics":"velor","temperature":6,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black"],"_id":"5c33a0d78234561ce924f701","name":"black coat","category":"coat","fabrics":"unknown","temperature":9,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["bleu"],"_id":"5c33a1508234561ce924f702","name":"blue jean","category":"jean","fabrics":"jean","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c33a3158234561ce924f706","name":"leather black pants","category":"pants","fabrics":"leather","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red"],"_id":"5c33a41a8234561ce924f708","name":"false fur sweater","category":"sweater","fabrics":"fur","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["white","black"],"_id":"5c33a46a8234561ce924f709","name":"striped pants","category":"pants","fabrics":"canvas","temperature":4,"pattern":"striped","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["grey"],"_id":"5c34731b77b02507b1cbc212","name":"grey coat","category":"coat","fabrics":"synthetic","temperature":8,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["orange"],"_id":"5c34745077b02507b1cbc214","name":"orange sweat","category":"sweatshirt","fabrics":"wool","temperature":7,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["beige"],"_id":"5c3373f8f946f80646b32d06","fabrics":"unknown","name":"beige pants","category":"pants","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black","red"],"_id":"5c3374d5f946f80646b32d07","fabrics":"cotton","name":"black hoodie","category":"hoodie","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4,5],"colors":["brown"],"_id":"5c337f87f946f80646b32d18","fabrics":"suede","name":"brown coat","category":"coat","temperature":8,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["taupe"],"_id":"5c33822ff946f80646b32d1e","fabrics":"cotton","name":"taupe hoodie","category":"hoodie","pattern":"uni","temperature":5,"layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["orange"],"_id":"5c338323f946f80646b32d20","fabrics":"unknown","name":"orange tshirt","category":"tshirt","pattern":"uni","temperature":3,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white"],"_id":"5c3383a8f946f80646b32d21","fabrics":"unknown","name":"white tshirt","category":"tshirt","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["pink"],"_id":"5c3383f3f946f80646b32d23","fabrics":"unknown","name":"pink tshirt","category":"tshirt","pattern":"uni","temperature":3,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["red"],"_id":"5c338435f946f80646b32d24","fabrics":"unknown","name":"red tshirt","category":"tshirt","pattern":"uni","temperature":3,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c3384eaf946f80646b32d27","fabrics":"jean","name":"jean shirt","category":"shirt","pattern":"uni","temperature":4,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["white"],"_id":"5c338516f946f80646b32d28","fabrics":"cloth","name":"white shirt","category":"shirt","pattern":"uni","temperature":3,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["blue"],"_id":"5c33854bf946f80646b32d29","fabrics":"cotton","name":"blue shirt","category":"shirt","temperature":2,"pattern":"lace","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["blue","white"],"_id":"5c338584f946f80646b32d2a","fabrics":"cotton","name":"blue tshirt","category":"tshirt","pattern":"uni","temperature":3,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["pink"],"_id":"5c3385b4f946f80646b32d2b","fabrics":"cotton","name":"pink shirt","category":"shirt","pattern":"lace","temperature":2,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["blue","white"],"_id":"5c3385e5f946f80646b32d2c","fabrics":"cotton","name":"white tshirt","category":"tshirt","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red"],"_id":"5c338b05b03bdf179c54fffc","name":"red shirt","category":"shirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["black"],"_id":"5c33905bb03bdf179c54fffd","name":"black polo","category":"polo","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["grey"],"_id":"5c339130b03bdf179c54fffe","name":"grey turtleneck","category":"turtleneck","fabrics":"wool","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["black"],"_id":"5c33926cb03bdf179c550001","name":"black leather short","category":"short","fabrics":"leather","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red"],"_id":"5c3393a18234561ce924f6fc","name":"red sweater","category":"sweater","fabrics":"wool","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["red"],"_id":"5c3394608234561ce924f6fd","name":"red velor pants","category":"pants","fabrics":"velor","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["white","black","red"],"_id":"5c3395138234561ce924f6ff","name":"salor sweater","category":"sweater","fabrics":"cotton","temperature":5,"pattern":"salor","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black","white","blue"],"_id":"5c33a2b68234561ce924f705","name":"striped sweater","category":"sweater","fabrics":"cotton","temperature":5,"pattern":"striped","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["black","blue","white"],"_id":"5c33a3b28234561ce924f707","name":"flowery tank top","category":"tank top","fabrics":"unknown","temperature":2,"pattern":"flowery","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue","green","white"],"_id":"5c3383cef946f80646b32d22","fabrics":"cotton","name":"flowery shirt","category":"shirt","temperature":4,"pattern":"flowery","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["blue"],"_id":"5c34720c77b02507b1cbc211","name":"blue jean","category":"jean","fabrics":"jean","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["grey","blue","white"],"_id":"5c3473d177b02507b1cbc213","name":"grey blue sweat","category":"sweatshirt","fabrics":"cotton","temperature":6,"pattern":"stripped","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red","yellow","purple","white"],"_id":"5c3475e877b02507b1cbc216","name":"native american pullover","category":"sweat","fabrics":"wool","temperature":6,"pattern":"printed","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["yellow"],"_id":"5c34770f77b02507b1cbc217","name":"yellow pants","category":"pants","fabrics":"cotton","temperature":4,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["burgundy"],"_id":"5c3477bc77b02507b1cbc218","name":"burgundy legging","category":"legging","fabrics":"synthetic","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c3479ac77b02507b1cbc219","name":"sarouel noir","category":"sarouel","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c347b7d77b02507b1cbc21a","name":"sweat scintillant","category":"sarouel","fabrics":"wool","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["turquoise"],"_id":"5c347c8d77b02507b1cbc21b","name":"turquoise tanktop","category":"tanktop","fabrics":"cotton","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black"],"_id":"5c347d7c77b02507b1cbc21c","name":"princess sweater","category":"sweater","fabrics":"cotton","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["yellow"],"_id":"5c347dc577b02507b1cbc21d","name":"yellow coat","category":"coat","fabrics":"synthetic","temperature":7,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["orange"],"_id":"5c347ea877b02507b1cbc21e","name":"orange sweater","category":"sweater","fabrics":"wool","temperature":7,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["burgundy"],"_id":"5c347f6877b02507b1cbc21f","name":"burgundy coat","category":"coat","fabrics":"synthetic","temperature":7,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white"],"_id":"5c34845c77b02507b1cbc222","name":"white tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["kaki"],"_id":"5c3484f177b02507b1cbc224","name":"kaki tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["blue"],"_id":"5c34853977b02507b1cbc226","name":"blue tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white"],"_id":"5c3485a577b02507b1cbc228","name":"white levis tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white","red"],"_id":"5c3486ed77b02507b1cbc22a","name":"red and white tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white","red"],"_id":"5c34872077b02507b1cbc22b","name":"red and grey tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black"],"_id":"5c3487ad77b02507b1cbc22c","name":"black vest","category":"vest","fabrics":"leather","temperature":6,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["beige"],"_id":"5c34888877b02507b1cbc22f","name":"beige vest","category":"vest","fabrics":"synthetic","temperature":7,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["grey"],"_id":"5c348a0677b02507b1cbc230","name":"grey vest","category":"vest","fabrics":"wool","temperature":7,"pattern":"checked","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c348a8377b02507b1cbc231","name":"blue vest","category":"vest","fabrics":"jean","temperature":7,"pattern":"stipped","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black"],"_id":"5c348af577b02507b1cbc232","name":"back shirt","category":"shirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c348b3d77b02507b1cbc233","name":"jean shirt","category":"shirt","fabrics":"jean","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c348b7e77b02507b1cbc234","name":"jean shirt","category":"shirt","fabrics":"jean","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["kaki"],"_id":"5c348c3777b02507b1cbc235","name":"kaki jogging","category":"jogging","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["brown"],"_id":"5c348cfe77b02507b1cbc236","name":"brown shorts","category":"shorts","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["blue"],"_id":"5c348d4b77b02507b1cbc237","name":"blue shorts","category":"shorts","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c348dea77b02507b1cbc238","name":"black jogging","category":"jogging","fabrics":"cotton","temperature":4,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["blue"],"_id":"5c348e3077b02507b1cbc239","name":"blue jean","category":"jean","fabrics":"jean","temperature":4,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["kaki"],"_id":"5c348eb577b02507b1cbc23a","name":"kaki jogging","category":"jogging","fabrics":"cotton","temperature":4,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["black"],"_id":"5c348eff77b02507b1cbc23b","name":"black jean shorts","category":"shorts","fabrics":"jean","temperature":4,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["blue"],"_id":"5c3490027d3f56190147f098","name":"blue jean","category":"jean","fabrics":"jean","temperature":4,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue","white"],"_id":"5c3491017d3f56190147f099","name":"jean coat","category":"coat","fabrics":"jean","temperature":6,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["blue","white"],"_id":"5c34917e7d3f56190147f09a","name":"flowery tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"flowery","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue","grey"],"_id":"5c3491e57d3f56190147f09b","name":"jean coat","category":"coat","fabrics":"jean","temperature":6,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["blue"],"_id":"5c3492487d3f56190147f09c","name":"blue tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["blue"],"_id":"5c3492f87d3f56190147f09d","name":"blue jacket","category":"jacket","fabrics":"cloth","temperature":5,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["pink","black","white"],"_id":"5c34bc097d3f56190147f09e","name":"pink cardigan","category":"cardigan","fabrics":"cotton","temperature":4,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white"],"_id":"5c34bc5a7d3f56190147f09f","name":"white tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["red"],"_id":"5c34bc7a7d3f56190147f0a0","name":"red tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["black","white"],"_id":"5c34bca47d3f56190147f0a1","name":"black tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white","black"],"_id":"5c34bcd27d3f56190147f0a2","name":"dotted tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["grey","black"],"_id":"5c34bd367d3f56190147f0a4","name":"black grey tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["pink"],"_id":"5c34bdcd7d3f56190147f0a7","name":"pink tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["blue"],"_id":"5c34bdec7d3f56190147f0a8","name":"blue tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["yellow"],"_id":"5c34be5b7d3f56190147f0a9","name":"yellow sweater","category":"sweater","fabrics":"wool","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black"],"_id":"5c34bea07d3f56190147f0aa","name":"black sweater","category":"sweater","fabrics":"unknown","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c34bf7c7d3f56190147f0ac","name":"blue sweater","category":"sweater","fabrics":"synthetic","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["brown"],"_id":"5c34bf9c7d3f56190147f0ad","name":"brown sweater","category":"sweater","fabrics":"wool","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["yellow"],"_id":"5c34c0337d3f56190147f0af","name":"yellow short","category":"shorts","fabrics":"synthetic","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["pink"],"_id":"5c34c0457d3f56190147f0b0","name":"pink sweater","category":"sweater","fabrics":"wool","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["white"],"_id":"5c34c05b7d3f56190147f0b1","name":"white short","category":"shorts","fabrics":"cloth","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["mustard"],"_id":"5c34c08a7d3f56190147f0b2","name":"mustard sweater","category":"sweater","fabrics":"wool","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["grey"],"_id":"5c34c0957d3f56190147f0b3","name":"grey short","category":"shorts","fabrics":"cotton","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["red"],"_id":"5c34c0c47d3f56190147f0b4","name":"red short","category":"shorts","fabrics":"cotton","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["white"],"_id":"5c34c0e77d3f56190147f0b5","name":"white hoodie","category":"hoodie","fabrics":"synthetic","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["white","black"],"_id":"5c34c0f27d3f56190147f0b6","name":"white and black short","category":"shorts","fabrics":"cloth","temperature":1,"pattern":"stripped","layer":1,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["green","black"],"_id":"5c34c11d7d3f56190147f0b8","name":"millitary short","category":"shorts","fabrics":"cotton","temperature":1,"pattern":"camo","layer":1,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["pink"],"_id":"5c34c15d7d3f56190147f0b9","name":"pink short","category":"shorts","fabrics":"cotton","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["beige"],"_id":"5c34c1707d3f56190147f0ba","name":"beige sweater","category":"sweater","fabrics":"synthetic","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["blue"],"_id":"5c34c1a17d3f56190147f0bb","name":"flower short","category":"shorts","fabrics":"jean","temperature":1,"pattern":"printed","layer":1,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["blue"],"_id":"5c34c1ee7d3f56190147f0be","name":"jean short","category":"shorts","fabrics":"jean","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["kaki"],"_id":"5c34c2207d3f56190147f0bf","name":"kaki short","category":"shorts","fabrics":"cloth","temperature":1,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["white","red"],"_id":"5c34c2217d3f56190147f0c0","name":"stripped white long sleeve tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"stripped","layer":1,"version":0,"rl_score":0},{"bodyparts":[5],"colors":["gold","black"],"_id":"5c34c2717d3f56190147f0c1","name":"flower short","category":"shorts","fabrics":"cloth","temperature":1,"pattern":"printed","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red"],"_id":"5c34c2857d3f56190147f0c3","name":"red blouse","category":"blouse","fabrics":"cloth","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["white"],"_id":"5c34c2d27d3f56190147f0c4","name":"white shirt","category":"shirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue"],"_id":"5c34c3057d3f56190147f0c5","name":"blue shirt","category":"shirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red"],"_id":"5c34c31e7d3f56190147f0c6","name":"red shirt","category":"shirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["white"],"_id":"5c34c33c7d3f56190147f0c7","name":"white shirt","category":"shirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["pink"],"_id":"5c34c34d7d3f56190147f0c8","name":"pink shirt","category":"shirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["bleu"],"_id":"5c34c3b17d3f56190147f0ca","name":"blue jean coat","category":"coat","fabrics":"jean","temperature":7,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["bleu","white"],"_id":"5c34c3da7d3f56190147f0cb","name":"blue jean coat sleeveless","category":"coat","fabrics":"jean","temperature":4,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["back"],"_id":"5c34c4037d3f56190147f0cc","name":"black jean coat sleeveless","category":"coat","fabrics":"jean","temperature":4,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["back"],"_id":"5c34c41f7d3f56190147f0cd","name":"black jean coat","category":"coat","fabrics":"jean","temperature":7,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["grey","white"],"_id":"5c34c4497d3f56190147f0ce","name":"grey jean coat","category":"coat","fabrics":"jean","temperature":7,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["brown","white"],"_id":"5c34c4657d3f56190147f0cf","name":"brown jean coat","category":"coat","fabrics":"jean","temperature":7,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["beige"],"_id":"5c34c4a17d3f56190147f0d0","name":"beige fur coat","category":"coat","fabrics":"fur","temperature":8,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red","white"],"_id":"5c34c4c87d3f56190147f0d1","name":"red jean coat","category":"coat","fabrics":"jean","temperature":7,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["grey","black","black"],"_id":"5c34c5307d3f56190147f0d2","name":"grey holister hoodie","category":"hoodie","fabrics":"cotton","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["blue"],"_id":"5c34c5807d3f56190147f0d3","name":"blue short","category":"short","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["grey"],"_id":"5c34c59f7d3f56190147f0d4","name":"grey short","category":"short","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["grey"],"_id":"5c34c5c07d3f56190147f0d5","name":"grey jean short","category":"short","fabrics":"jean","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["blue"],"_id":"5c34c5ec7d3f56190147f0d6","name":"blue jean short","category":"short","fabrics":"jean","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["blue"],"_id":"5c34c6897d3f56190147f0d7","name":"skinny blue jean","category":"jean","fabrics":"jean","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["red"],"_id":"5c34c6d77d3f56190147f0d8","name":"skinny red jean","category":"jean","fabrics":"jean","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["grey"],"_id":"5c34c7137d3f56190147f0d9","name":"grey legging sport","category":"legging","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c34c73b7d3f56190147f0da","name":"black legging puma","category":"legging","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["grey"],"_id":"5c34c78c7d3f56190147f0dc","name":"grey pants","category":"pants","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["blue"],"_id":"5c34c7ea7d3f56190147f0de","name":"blue suit pants","category":"pants","fabrics":"cloth","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c34c8057d3f56190147f0df","name":"black suit pants","category":"pants","fabrics":"cloth","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["grey"],"_id":"5c34c82b7d3f56190147f0e0","name":"grey suit pants","category":"pants","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["beige"],"_id":"5c34c88f7d3f56190147f0e1","name":"beige pants","category":"pants","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["blue"],"_id":"5c34c8b87d3f56190147f0e2","name":"blue jean","category":"jeans","fabrics":"jean","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["blue","white"],"_id":"5c34c8f47d3f56190147f0e3","name":"printed short","category":"short","fabrics":"cotton","temperature":2,"pattern":"printed","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["red"],"_id":"5c34c9387d3f56190147f0e4","name":"red skirt","category":"skirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["grey"],"_id":"5c34c9a37d3f56190147f0e5","name":"grey skirt","category":"skirt","fabrics":"suede","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["beige"],"_id":"5c34c9d27d3f56190147f0e6","name":"beige suite pants","category":"pants","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red","black","white"],"_id":"5c34ca1e7d3f56190147f0e7","name":"check red black coat","category":"coat","fabrics":"synthetic","temperature":9,"pattern":"check","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["black"],"_id":"5c34ca567d3f56190147f0e8","name":"black suit jacket","category":"jacket","fabrics":"cotton","temperature":3,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white","black"],"_id":"5c34caf77d3f56190147f0ec","name":"white black printed suit jacket","category":"jacket","fabrics":"cotton","temperature":3,"pattern":"printed","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["black"],"_id":"5c34cb617d3f56190147f0ed","name":"black printed jacket","category":"jacket","fabrics":"cloth","temperature":3,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["yellow","blue"],"_id":"5c34cbb67d3f56190147f0ee","name":"dotted tank top","category":"tank top","fabrics":"cotton","temperature":2,"pattern":"dotted","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["black"],"_id":"5c34cbcf7d3f56190147f0ef","name":"black tank top","category":"tank top","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["black","grey"],"_id":"5c34cbf07d3f56190147f0f0","name":"addidas black tank top","category":"tank top","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["blue"],"_id":"5c35e02d5ded4e1755682436","name":"blue jeans","category":"jean","fabrics":"jean","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue","white","red"],"_id":"5c337c96f946f80646b32d12","fabrics":"wool","name":"Xmas sweater","category":"sweater","temperature":6,"pattern":"Xmas","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6],"colors":["brown","beige","white"],"_id":"5c338147f946f80646b32d1b","fabrics":"cotton","name":"check skirt","category":"skirt","pattern":"pledge","temperature":2,"layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["green","white"],"_id":"5c33a1c38234561ce924f703","name":"green sweater","category":"sweater","fabrics":"cotton","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black","white","green"],"_id":"5c33a20e8234561ce924f704","name":"black check pants","category":"pants","fabrics":"unknown","temperature":5,"pattern":"check","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black","grey"],"_id":"5c34752f77b02507b1cbc215","name":"legging millitaire","category":"legging","fabrics":"synthetic","temperature":4,"pattern":"camo","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue","white","pink"],"_id":"5c337eb3f946f80646b32d17","fabrics":"wool","name":"blue sweater","category":"sweater","temperature":4,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red","white"],"_id":"5c3381f7f946f80646b32d1d","fabrics":"unknown","name":"check red shirt","category":"shirt","temperature":4,"pattern":"check","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red","white"],"_id":"5c3384b4f946f80646b32d26","fabrics":"cotton","name":"printed shirt","category":"shirt","pattern":"printed","temperature":4,"layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["red","white","pink"],"_id":"5c339180b03bdf179c54ffff","name":"printed pants","category":"pants","fabrics":"unknown","temperature":5,"pattern":"printed","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["white","pink","green"],"_id":"5c339214b03bdf179c550000","name":"Xmas sweater","category":"sweaeter","fabrics":"wool","temperature":6,"pattern":"Xmas","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["grey","black"],"_id":"5c3483bb77b02507b1cbc220","name":"grey and black tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["yellow"],"_id":"5c34842477b02507b1cbc221","name":"yellow superdry sweater","category":"sweater","fabrics":"cotton","temperature":6,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white","blue"],"_id":"5c34849377b02507b1cbc223","name":"white and blue tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"stripped","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white","blue","red"],"_id":"5c34868077b02507b1cbc229","name":"blue white red tshirt","category":"tshirt","fabrics":"cotton","temperature":3,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue","white","brown"],"_id":"5c34880277b02507b1cbc22e","name":"dirty jean vest","category":"vest","fabrics":"jean","temperature":6,"pattern":"uni","layer":3,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white","black","red"],"_id":"5c34bd097d3f56190147f0a3","name":"white girls tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["black","green"],"_id":"5c34bd677d3f56190147f0a5","name":"black flowery tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"flowery","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black","white"],"_id":"5c34c10d7d3f56190147f0b7","name":"black nike hoodie","category":"hoodie","fabrics":"cotton","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue","white"],"_id":"5c34c1b17d3f56190147f0bc","name":"addidas blue sweater","category":"sweater","fabrics":"cotton","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black","white","blue"],"_id":"5c34c37e7d3f56190147f0c9","name":"check shirt","category":"shirt","fabrics":"cotton","temperature":3,"pattern":"check","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["black","white"],"_id":"5c34c7557d3f56190147f0db","name":"black legging addida","category":"legging","fabrics":"cotton","temperature":5,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[5,6,7],"colors":["blue","white"],"_id":"5c34c7b97d3f56190147f0dd","name":"blue dotted legging","category":"legging","fabrics":"cloth","temperature":5,"pattern":"dotted","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["blue","white"],"_id":"5c34bfff7d3f56190147f0ae","name":"blue sweater","category":"sweater","fabrics":"cotton","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["white","black"],"_id":"5c34bd967d3f56190147f0a6","name":"palmtree tshirt","category":"tshirt","fabrics":"cotton","temperature":2,"pattern":"palmtree","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black","pink"],"_id":"5c34bef57d3f56190147f0ab","name":"pink floyd sweater","category":"sweater","fabrics":"cotton","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["red","white"],"_id":"5c34c1cd7d3f56190147f0bd","name":"addidas red sweater","category":"sweater","fabrics":"cotton","temperature":5,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["grey","white"],"_id":"5c34cacb7d3f56190147f0eb","name":"grey dotted suit jacket","category":"jacket","fabrics":"cotton","temperature":3,"pattern":"dotted","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3,4],"colors":["black","white"],"_id":"5c35dfe55ded4e1755682435","name":"white and black sweater","category":"sweater","fabrics":"cotton","temperature":7,"pattern":"uni","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["grey","white"],"_id":"5c34ca7c7d3f56190147f0e9","name":"grey dotted suit jacket","category":"jacket","fabrics":"cotton","temperature":3,"pattern":"dotted","layer":2,"version":0,"rl_score":0},{"bodyparts":[1,2],"colors":["blue","pink","white"],"_id":"5c34cc1a7d3f56190147f0f1","name":"superdry malibu tank top","category":"tank top","fabrics":"cotton","temperature":2,"pattern":"uni","layer":1,"version":0,"rl_score":0},{"bodyparts":[1,2,3],"colors":["beige","black"],"_id":"5c34cab27d3f56190147f0ea","name":"beige check suit jacket","category":"jacket","fabrics":"cotton","temperature":3,"pattern":"check","layer":2,"version":0,"rl_score":0}],"rl_cat_score":{"0":{"tshirt":0.3333333333333333,"tanktop":0,"shirt":0,"blouse":0,"tank top":0,"polo":0},"1":{"short":0,"pants":0,"jean":0.3333333333333333,"legging":0,"sarouel":0,"shorts":0,"skirt":0,"jogging":0,"jeans":0},"2":{"cardigan":0,"turtleneck":0,"hoodie":0,"sweater":0,"sweat":0,"sweaeter":0,"jacket":0,"sweatshirt":0},"3":{"vest":0,"coat":0.3333333333333333,"trench":0,"jacket":0}},"tastes":[{"clothes":[{"bodyparts":[1,2,3],"colors":["blue"],"_id":"5c33854bf946f80646b32d29","category":"shirt","fabrics":"cotton","layer":1,"name":"blue shirt","pattern":"lace","rl_score":0,"temperature":2},{"bodyparts":[5,6,7],"colors":["black"],"_id":"5c3479ac77b02507b1cbc219","category":"sarouel","fabrics":"cotton","layer":1,"name":"sarouel noir","pattern":"uni","rl_score":0,"temperature":5}],"_id":"5c4f2824556df753dd6a5dcd","decision":true,"rl_used":false},{"clothes":[{"bodyparts":[5,6,7],"colors":["yellow"],"_id":"5c34770f77b02507b1cbc217","category":"pants","fabrics":"cotton","layer":1,"name":"yellow pants","pattern":"uni","rl_score":0,"temperature":4},{"bodyparts":[1,2,3,4],"colors":["black","white","blue"],"_id":"5c34c37e7d3f56190147f0c9","category":"shirt","fabrics":"cotton","layer":1,"name":"check shirt","pattern":"check","rl_score":0,"temperature":3}],"_id":"5c4f282c556df753dd6a5dd0","decision":false,"rl_used":false}]}')
    clothes = args_json["clothes"]
    rl_cat_score = args_json["rl_cat_score"]
    tastes = args_json["tastes"]
    rl = RL(clothes, rl_cat_score)
    clothes_cat_score = {}
    print(tastes)
    if tastes:
        for taste in tastes:
            if taste["rl_used"]:
                continue
            rl.update_value_naive(taste)
            taste["rl_used"] = True

        clothes_cat_score = rl.prepare_update_value_2()
        clothes_cat_score.update({"tastes": tastes})

    outfit = rl.create_outfit()
    clothes_cat_score.update(outfit)
    print(clothes_cat_score["rl_cat_score"])


    # with open('../database/clothes3.json') as data_file:
    #     data = json.load(data_file)
    # cat_score = data["rl_cat_score"]
    # clothes = data["clothes"]
    # for clothe in clothes:
    #     clothe["rl_score"] = 0.0
    #
    # print(clothes)
    # print(cat_score)
    # rl = RL(clothes, cat_score)
    # with open("tastes2.json") as file:
    #     tastes = json.load(file)
    #
    # print(rl.cat_score_s[0].to_dict())
    # rl.update_value_naive(tastes[0])
